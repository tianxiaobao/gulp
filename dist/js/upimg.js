define(function(require,exports,module){"use strict";function Upimg(){this.init()}var $=require("jquery");Upimg.prototype.init=function(){function sendFile(f){var uploadUrl="/ajaxupload.php";$.ajax({url:uploadUrl,type:"POST",contentType:!1,processData:!1,cache:!1,data:f,success:function(e){var msg=JSON.parse(e);$("input[data-id="+a+"]").attr("value",msg.key),$("input[data-id="+a+"]").next().attr("src","../"+msg.key)},error:function(e){}})}function handleFiles(files){var tim=new Date,day=tim.getDate(),year=tim.getFullYear(),month=tim.getMonth()+1;month=month<10?"0"+month:month;for(var i=0;i<files.length;i++){var fd=new FormData;if(files[i].type.match("image.*")){fd.append("file",files[i]),fd.append("fileurl","uploadfile/member/"+year+month+day+"/"),sendFile(fd);break}}}$(".show-image i").each(function(i){$(this).click(function(){$(this).parents(".ui-form-item").find("input").val(""),$(this).parent().remove()})});var a;$(".a-upload input").bind("change",function(e){a=e.target;var fs=e.target.files||e.dataTransfer&&e.dataTransfer.files;handleFiles(fs)})},module.exports=new Upimg});